<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø³Ù„Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ - Ø±ÙƒÙ† Ø§Ù„Ø¨ÙŠØª</title>
  <link rel="stylesheet" href="styles/main.css" />
  <style>
    body {
      font-family: Tahoma, sans-serif;
      background-color: #f8f8f8;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #004aad;
      color: white;
      padding: 20px;
      text-align: center;
    }

    main {
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    table, th, td {
      border: 1px solid #ccc;
    }

    th, td {
      padding: 12px;
      text-align: center;
    }

    .totals {
      text-align: right;
      margin-top: 20px;
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }

    input, button {
      padding: 10px;
      margin: 5px 0;
      width: 100%;
      box-sizing: border-box;
    }

    .discount {
      color: green;
      font-weight: bold;
    }

    .error {
      color: red;
    }

    .customer-info {
      margin-top: 30px;
    }

    .continue-btn {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 12px;
      border-radius: 6px;
      margin-top: 20px;
      width: 100%;
      cursor: pointer;
    }

    .continue-btn:hover {
      background-color: #0056b3;
    }

    footer {
      background-color: #004aad;
      color: white;
      text-align: center;
      padding: 15px;
      margin-top: 40px;
    }
  </style>
</head>
<body>

  <header>
    <h1>Ø³Ù„Ø© Ø§Ù„Ø´Ø±Ø§Ø¡</h1>
  </header>

  <main>
    <table id="cart-table">
      <thead>
        <tr>
          <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
          <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
          <th>Ø§Ù„Ø³Ø¹Ø±</th>
          <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
        </tr>
      </thead>
      <tbody>
        <!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
      </tbody>
    </table>

    <div>
      <label>Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…:</label>
      <input type="text" id="discount-code" placeholder="Ø§ÙƒØªØ¨ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…" />
      <button onclick="applyDiscount()">ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®ØµÙ…</button>
      <p id="discount-message"></p>
    </div>

    <div class="totals">
      <p id="discount-percent"></p>
      <p id="discount-amount"></p>
      <p><strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="total">0</span> Ø¯.Ø¹</strong></p>
    </div>

    <div class="customer-info">
      <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ†:</h3>
      <input type="text" id="customer-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required />
      <input type="text" id="customer-address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" required />
      <input type="text" id="customer-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required />
      <button onclick="sendOrder()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
    </div>

    <button class="continue-btn" onclick="location.href='index.html'">ğŸ“¦ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ØªØ³ÙˆÙ‚</button>
  </main>

  <footer>
    &copy; 2025 Ø±ÙƒÙ† Ø§Ù„Ø¨ÙŠØª
  </footer>

  <script>
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartTable = document.querySelector("#cart-table tbody");
    const totalSpan = document.getElementById("total");
    const discountPercent = document.getElementById("discount-percent");
    const discountAmount = document.getElementById("discount-amount");
    const discountMessage = document.getElementById("discount-message");

    let discountValue = 0;
    let discountType = "";

    function renderCart() {
      cartTable.innerHTML = "";
      let total = 0;

      cart.forEach((item, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${item.name}</td>
          <td>${item.quantity}</td>
          <td>${item.price * item.quantity} Ø¯.Ø¹</td>
          <td><button onclick="removeItem(${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button></td>
        `;
        cartTable.appendChild(row);
        total += item.price * item.quantity;
      });

      let discountText = "";
      let discountDisplay = 0;

      if (discountType === "percent") {
        discountDisplay = Math.floor(total * discountValue);
        discountText = `${discountValue * 100}% Ø®ØµÙ…`;
      } else if (discountType === "free_shipping") {
        discountDisplay = 2500;
        discountText = `Ø®ØµÙ… ØªÙˆØµÙŠÙ„ (2500 Ø¯.Ø¹)`;
      }

      const finalTotal = Math.max(0, total - discountDisplay);

      discountPercent.textContent = discountText ? `ğŸ’¸ ${discountText}` : "";
      discountAmount.textContent = discountDisplay ? `- ${discountDisplay} Ø¯.Ø¹` : "";
      totalSpan.textContent = finalTotal;
    }

    function removeItem(index) {
      cart.splice(index, 1);
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }

    function applyDiscount() {
      const code = document.getElementById("discount-code").value.trim();
      discountValue = 0;
      discountType = "";
      discountMessage.textContent = "";

      if (code === "DISC5") {
        discountValue = 0.05;
        discountType = "percent";
        discountMessage.textContent = "ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… 5%";
        discountMessage.className = "discount";
      } else if (code === "DISC10") {
        discountValue = 0.10;
        discountType = "percent";
        discountMessage.textContent = "ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… 10%";
        discountMessage.className = "discount";
      } else if (code === "FREESHIP") {
        discountType = "free_shipping";
        discountMessage.textContent = "ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ";
        discountMessage.className = "discount";
      } else {
        discountMessage.textContent = "âŒ ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­";
        discountMessage.className = "error";
        return;
      }

      renderCart();
    }

    function sendOrder() {
      const name = document.getElementById("customer-name").value.trim();
      const address = document.getElementById("customer-address").value.trim();
      const phone = document.getElementById("customer-phone").value.trim();

      if (!name || !address || !phone) {
        alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ†");
        return;
      }

      let message = `ğŸ›’ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø±ÙƒÙ† Ø§Ù„Ø¨ÙŠØª:\n\n`;
      cart.forEach(item => {
        message += `- ${item.name} Ã— ${item.quantity} = ${item.price * item.quantity} Ø¯.Ø¹\n`;
      });

      message += `\n`;
      if (discountType === "percent") {
        message += `âœ… Ø®ØµÙ… ${discountValue * 100}%\n`;
      } else if (discountType === "free_shipping") {
        message += `âœ… ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ\n`;
      }

      message += `ğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…: ${totalSpan.textContent} Ø¯.Ø¹\n\n`;
      message += `ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${name}\nğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${address}\nğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: ${phone}`;

      const url = `https://wa.me/9647761384712?text=${encodeURIComponent(message)}`;
      window.open(url, "_blank");
    }

    renderCart();
  </script>

</body>
</html>